# CI/CD and Code Quality Setup

ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«ã¯ä»¥ä¸‹ã®CI/CDã¨ã‚³ãƒ¼ãƒ‰å“è³ªãƒã‚§ãƒƒã‚¯ãƒ„ãƒ¼ãƒ«ãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã™ã€‚

## GitHub Actions

### CI Workflow (`.github/workflows/ci.yml`)

**ãƒˆãƒªã‚¬ãƒ¼**:
- `push`: main, master, develop, architecture ãƒ–ãƒ©ãƒ³ãƒã¸ã®ãƒ—ãƒƒã‚·ãƒ¥
- `pull_request`: main, master, develop ãƒ–ãƒ©ãƒ³ãƒã¸ã®PR

**ã‚¸ãƒ§ãƒ–**:

#### 1. Build and Test
- ã‚³ãƒ¼ãƒ‰ã®ãƒã‚§ãƒƒã‚¯ã‚¢ã‚¦ãƒˆ
- JDK 17ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
- Gradleã‚­ãƒ£ãƒƒã‚·ãƒ¥
- ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ“ãƒ«ãƒ‰
- ãƒ†ã‚¹ãƒˆã®å®Ÿè¡Œ
- ãƒ“ãƒ«ãƒ‰ãƒ¬ãƒãƒ¼ãƒˆã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰

#### 2. Code Quality Check
- ktlintã«ã‚ˆã‚‹ã‚³ãƒ¼ãƒ‰ã‚¹ã‚¿ã‚¤ãƒ«ãƒã‚§ãƒƒã‚¯
- detektã«ã‚ˆã‚‹é™çš„è§£æž
- Lintãƒ¬ãƒãƒ¼ãƒˆã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰

## ktlint

Kotlinã®ã‚³ãƒ¼ãƒ‰ã‚¹ã‚¿ã‚¤ãƒ«ãƒã‚§ãƒƒã‚«ãƒ¼

**å®Ÿè¡Œæ–¹æ³•**:
```bash
./gradlew ktlintCheck         # ãƒã‚§ãƒƒã‚¯ã®ã¿
./gradlew ktlintFormat        # è‡ªå‹•ãƒ•ã‚©ãƒ¼ãƒžãƒƒãƒˆ
```

**è¨­å®š**:
- ãƒãƒ¼ã‚¸ãƒ§ãƒ³: 1.1.1
- è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«: `.editorconfig`

## detekt

Kotlinã®é™çš„è§£æžãƒ„ãƒ¼ãƒ«

**å®Ÿè¡Œæ–¹æ³•**:
```bash
./gradlew detekt
```

**è¨­å®š**:
- è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«: `config/detekt/detekt.yml`
- æœ€å¤§è¡Œæ•°: 120
- é–¢æ•°ã®é•·ã•: 60è¡Œã¾ã§
- ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æ•°: 6å€‹ã¾ã§

**ãƒã‚§ãƒƒã‚¯å†…å®¹**:
- ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚¹ã‚¿ã‚¤ãƒ«
- è¤‡é›‘åº¦
- å‘½åè¦å‰‡
- æ½œåœ¨çš„ãªãƒã‚°
- ãƒ‘ãƒ•ã‚©ãƒ¼ãƒžãƒ³ã‚¹
- ç©ºã®ãƒ–ãƒ­ãƒƒã‚¯

## CODEOWNERS

`.github/CODEOWNERS`

**æ©Ÿèƒ½**:
- PRãŒä½œæˆã•ã‚Œã‚‹ã¨ã€å¤‰æ›´ã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ã«å¿œã˜ã¦è‡ªå‹•çš„ã«ãƒ¬ãƒ“ãƒ¥ã‚¢ãƒ¼ãŒå‰²ã‚Šå½“ã¦ã‚‰ã‚Œã‚‹

**ç¾åœ¨ã®è¨­å®š**:
- ã™ã¹ã¦ã®ãƒ•ã‚¡ã‚¤ãƒ«: @segnities007
- ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ: @segnities007
- å„ãƒ¬ã‚¤ãƒ¤ãƒ¼: @segnities007

## Git Hooks

### Pre-commit Hook

**ã‚³ãƒŸãƒƒãƒˆå‰ã«è‡ªå‹•å®Ÿè¡Œ**:
- `ktlintFormat` - ã‚³ãƒ¼ãƒ‰ã‚’è‡ªå‹•ãƒ•ã‚©ãƒ¼ãƒžãƒƒãƒˆ
- `ktlintCheck` - ãƒ•ã‚©ãƒ¼ãƒžãƒƒãƒˆãƒã‚§ãƒƒã‚¯
- `detekt` - é™çš„è§£æž

ã‚³ãƒŸãƒƒãƒˆå‰ã«è‡ªå‹•çš„ã«ã‚³ãƒ¼ãƒ‰ãŒãƒ•ã‚©ãƒ¼ãƒžãƒƒãƒˆã•ã‚Œã€å“è³ªãƒã‚§ãƒƒã‚¯ãŒå®Ÿè¡Œã•ã‚Œã¾ã™ã€‚

### Pre-push Hook

**ãƒ—ãƒƒã‚·ãƒ¥å‰ã«è‡ªå‹•å®Ÿè¡Œ**:
- `ktlintCheck` - ã‚³ãƒ¼ãƒ‰ã‚¹ã‚¿ã‚¤ãƒ«ãƒã‚§ãƒƒã‚¯
- `detekt` - é™çš„è§£æž
- `test` - ã™ã¹ã¦ã®ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ

**ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ–¹æ³•**:

åˆå›žã®ã¿ã€ä»¥ä¸‹ã®ã‚³ãƒžãƒ³ãƒ‰ã§Git Hooksã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«:
```bash
./gradlew setupGitHooks
```

ã¾ãŸã¯ã€ãƒ“ãƒ«ãƒ‰æ™‚ã«è‡ªå‹•çš„ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¾ã™:
```bash
./gradlew build
```

**Git Hooksã‚’ä¸€æ™‚çš„ã«ç„¡åŠ¹åŒ–**:
```bash
git commit --no-verify      # pre-commitã‚’ã‚¹ã‚­ãƒƒãƒ—
git push --no-verify        # pre-pushã‚’ã‚¹ã‚­ãƒƒãƒ—
```

> âš ï¸ **æ³¨æ„**: `--no-verify`ã¯ç·Šæ€¥æ™‚ã®ã¿ä½¿ç”¨ã—ã¦ãã ã•ã„ã€‚CI/CDã§åŒã˜ãƒã‚§ãƒƒã‚¯ãŒå®Ÿè¡Œã•ã‚Œã‚‹ãŸã‚ã€æœ€çµ‚çš„ã«ã¯ä¿®æ­£ãŒå¿…è¦ã§ã™ã€‚

## ãƒ­ãƒ¼ã‚«ãƒ«ã§ã®å®Ÿè¡Œ

### ã™ã¹ã¦ã®ãƒã‚§ãƒƒã‚¯ã‚’å®Ÿè¡Œ
```bash
./gradlew ktlintCheck detekt test
```

### è‡ªå‹•ä¿®æ­£
```bash
./gradlew ktlintFormat
```

### CIç’°å¢ƒã¨åŒã˜ã‚³ãƒžãƒ³ãƒ‰
```bash
./gradlew build test ktlintCheck detekt
```

## PRã®ãƒžãƒ¼ã‚¸å‰ã«ç¢ºèªã™ã‚‹ã“ã¨

- [ ] `./gradlew ktlintCheck` ãŒãƒ‘ã‚¹ã™ã‚‹
- [ ] `./gradlew detekt` ãŒãƒ‘ã‚¹ã™ã‚‹
- [ ] `./gradlew test` ãŒãƒ‘ã‚¹ã™ã‚‹
- [ ] `./gradlew build` ãŒæˆåŠŸã™ã‚‹

ã“ã‚Œã‚‰ã¯ GitHub Actions ã§è‡ªå‹•çš„ã«ãƒã‚§ãƒƒã‚¯ã•ã‚Œã¾ã™ã€‚

## Dependabot

`.github/dependabot.yml`

**æ©Ÿèƒ½**:
- Gradleä¾å­˜é–¢ä¿‚ã®è‡ªå‹•æ›´æ–°ï¼ˆæ¯Žé€±æœˆæ›œæ—¥ 09:00 JSTï¼‰
- GitHub Actionsã®è‡ªå‹•æ›´æ–°
- é–¢é€£ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ã‚°ãƒ«ãƒ¼ãƒ—åŒ–ï¼ˆkotlin, compose, testing, androidxï¼‰

**è¨­å®š**:
- åŒæ™‚ã‚ªãƒ¼ãƒ—ãƒ³PRæ•°: Gradle 5ä»¶ã€Actions 3ä»¶
- ãƒ©ãƒ™ãƒ«è‡ªå‹•ä»˜ä¸Ž: `dependencies`

## CodeQL Security Analysis

`.github/workflows/codeql.yml`

**æ©Ÿèƒ½**:
- Kotlin/Java ã‚³ãƒ¼ãƒ‰ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è„†å¼±æ€§ã‚’è‡ªå‹•æ¤œå‡º
- GitHub Security ã‚¿ãƒ–ã§çµæžœã‚’ç®¡ç†

**ãƒˆãƒªã‚¬ãƒ¼**:
- `push`: main, master, develop ãƒ–ãƒ©ãƒ³ãƒã¸ã®ãƒ—ãƒƒã‚·ãƒ¥
- `pull_request`: main, master, develop ãƒ–ãƒ©ãƒ³ãƒã¸ã®PR
- `schedule`: æ¯Žé€±æœˆæ›œæ—¥ 15:00 JST

## Stale Issue Management

`.github/workflows/stale.yml`

**æ©Ÿèƒ½**:
- 30æ—¥é–“æ´»å‹•ãŒãªã„Issue/PRã« `stale` ãƒ©ãƒ™ãƒ«ã‚’ä»˜ä¸Ž
- ã•ã‚‰ã«7æ—¥é–“æ´»å‹•ãŒãªã„å ´åˆã¯è‡ªå‹•ã‚¯ãƒ­ãƒ¼ã‚º

**é™¤å¤–ãƒ©ãƒ™ãƒ«**:
- Issue: `pinned`, `security`, `bug`, `enhancement`
- PR: `pinned`, `security`, `do-not-close`
- ãƒ‰ãƒ©ãƒ•ãƒˆPRã¯é™¤å¤–

## Gradle Wrapper Validation

`.github/workflows/gradle-wrapper-validation.yml`

**æ©Ÿèƒ½**:
- `gradle-wrapper.jar` ã®æ­£å½“æ€§ã‚’æ¤œè¨¼
- ã‚µãƒ—ãƒ©ã‚¤ãƒã‚§ãƒ¼ãƒ³æ”»æ’ƒå¯¾ç­–

**ãƒˆãƒªã‚¬ãƒ¼**:
- Gradle Wrapperé–¢é€£ãƒ•ã‚¡ã‚¤ãƒ«ãŒå¤‰æ›´ã•ã‚ŒãŸæ™‚ã®ã¿

## Dependency Review

`.github/workflows/dependency-review.yml`

**æ©Ÿèƒ½**:
- PRã§è¿½åŠ ã•ã‚ŒãŸä¾å­˜é–¢ä¿‚ã®è„†å¼±æ€§ã‚’ãƒã‚§ãƒƒã‚¯
- é«˜ãƒ»ã‚¯ãƒªãƒ†ã‚£ã‚«ãƒ«ãªè„†å¼±æ€§ã§PRã‚’ãƒ–ãƒ­ãƒƒã‚¯
- GPL-3.0, AGPL-3.0 ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã‚’æ‹’å¦

**ãƒˆãƒªã‚¬ãƒ¼**:
- PRãŒã‚ªãƒ¼ãƒ—ãƒ³ã•ã‚ŒãŸæ™‚

## PR Size Labeler

`.github/workflows/pr-size-labeler.yml`

**æ©Ÿèƒ½**:
- PRã®å¤‰æ›´è¡Œæ•°ã«å¿œã˜ã¦ãƒ©ãƒ™ãƒ«ã‚’è‡ªå‹•ä»˜ä¸Ž
- ãƒ¬ãƒ“ãƒ¥ãƒ¼å„ªå…ˆåº¦ã®åˆ¤æ–­ã«æ´»ç”¨

**ãƒ©ãƒ™ãƒ«**:
| ãƒ©ãƒ™ãƒ« | å¤‰æ›´è¡Œæ•° | ç›®å®‰ |
|--------|----------|------|
| ðŸŸ¢ è»½å¾®ãªä¿®æ­£ | â‰¤10è¡Œ | typoä¿®æ­£ã€1ç®‡æ‰€ã®å¤‰æ›´ |
| ðŸ”µ å°ã•ãªå¤‰æ›´ | â‰¤100è¡Œ | å˜ä¸€æ©Ÿèƒ½ã®è¿½åŠ ãƒ»ä¿®æ­£ |
| ðŸŸ¡ ä¸­è¦æ¨¡ã®å¤‰æ›´ | â‰¤500è¡Œ | è¤‡æ•°ãƒ•ã‚¡ã‚¤ãƒ«ã«ã¾ãŸãŒã‚‹æ©Ÿèƒ½ |
| ðŸŸ  å¤§ããªå¤‰æ›´ | â‰¤1000è¡Œ | æ–°æ©Ÿèƒ½ãƒ»ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚° |
| ðŸ”´ è¦æ³¨æ„ï¼šå¤§è¦æ¨¡å¤‰æ›´ | >1000è¡Œ | åˆ†å‰²æ¤œè¨Žã‚’æŽ¨å¥¨ |
